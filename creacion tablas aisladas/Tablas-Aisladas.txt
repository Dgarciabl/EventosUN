USE trabajobd;
##empresa
CREATE TABLE empresa(
      nit         INT(10) PRIMARY KEY ,
      nombre      VARCHAR(100) NOT NULL,
      direccion   VARCHAR(100) NOT NULL,
      telefono    VARCHAR(100) NOT NULL,
      tipo        VARCHAR(100) NOT NULL
)ENGINE=INNODB;
ALTER TABLE empresa ADD CONSTRAINT CKTE CHECK(tipo="externa");
ALTER TABLE empresa ADD CONSTRAINT CKTC CHECK(tipo="contratada");
##empresa subtipo externa
CREATE TABLE externa(
      nit         INT(10) PRIMARY KEY REFERENCES empresa(nit),
      representante  VARCHAR(100) NOT NULL
)ENGINE=INNODB;
##empresa subtipo contratada
CREATE TABLE contratada(
      nit            INT(10) PRIMARY KEY REFERENCES empresa(nit),
      especialidad      VARCHAR(100) NOT NULL
)ENGINE=INNODB;
ALTER TABLE contratada ADD CONSTRAINT CKEC CHECK(especialidad="catering");
ALTER TABLE contratada ADD CONSTRAINT CKED CHECK(especialidad="decoracion");
ALTER TABLE contratada ADD CONSTRAINT CKEE CHECK(especialidad="entretenimiento");
##evento
CREATE TABLE evento(
      nit                 INT(10) REFERENCES empresa(nit),
      cod_evento          INT(10) PRIMARY KEY AUTO_INCREMENT,
      razon               VARCHAR(100) NOT NULL,
      fecha               DATE NOT NULL,
      presupuesto         VARCHAR(100) NOT NULL,
      nombre              VARCHAR(100)
)ENGINE=INNODB;
ALTER TABLE evento ADD CONSTRAINT Fk_CK CHECK((nit_externa IS NULL AND nit_contratada IS NOT NULL) OR (nit_contratada IS NULL AND nit_externa IS NOT NULL));
ALTER TABLE evento ADD CONSTRAINT CKRC CHECK(razon="conferencia");
ALTER TABLE evento ADD CONSTRAINT CKRA CHECK(razon="aniversario");
ALTER TABLE evento ADD CONSTRAINT CKRR CHECK(razon="reunion");
ALTER TABLE evento ADD CONSTRAINT CKRU CHECK(razon="union");